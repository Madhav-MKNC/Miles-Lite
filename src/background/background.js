const REPORT_API_URL="http://miles.madhav-mknc.me/report_issue",REPLY_API_URL="http://miles.madhav-mknc.me/get_reply";async function report_issue_to_server(e){try{const r=await fetch(REPORT_API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"});if(!r.ok)return console.log(`Error in report_issue_to_server: HTTP status ${r.status}`),{};return await r.json()}catch(e){return console.log("Error in report_issue_to_server:",e.message),{}}}async function get_reply_response_from_server(e){try{const r=await fetch(REPLY_API_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"});if(!r.ok)return console.log(`Error in get_reply_response_from_server: HTTP status ${r.status}`),{};return await r.json()||{}}catch(e){return console.log("Error in get_reply_response_from_server:",e.message),{}}}chrome.runtime.onMessage.addListener(((e,r,t)=>{if("get_reply"===e.type){return get_reply_response_from_server(e.data).then((e=>{t({reply_response:e})})).catch((e=>{t({error:e.message})})),!0}if("report_issue"===e.type){return report_issue_to_server(e.data).then((e=>{t({success:!0,response:e})})).catch((e=>{t({success:!1,error:e.message})})),!0}})),chrome.runtime.onInstalled.addListener((e=>{"install"!==e.reason&&"update"!==e.reason||chrome.tabs.query({},(e=>{for(const r of e)r.id&&r.url&&r.url.startsWith("https://web.whatsapp.com/")&&chrome.scripting.executeScript({target:{tabId:r.id},func:()=>{alert("MILES is installed. Please refresh WhatsApp Web to activate it.")}})}))})),chrome.action.onClicked.addListener((()=>{const e=chrome.runtime.getURL("src/app/dashboard.html");chrome.tabs.query({},(r=>{let t=!1;for(let s of r)if(s.url===e){t=!0,chrome.tabs.update(s.id,{active:!0});break}t||chrome.tabs.create({url:e})}))}));